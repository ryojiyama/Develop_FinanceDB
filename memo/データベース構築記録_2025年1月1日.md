 # 家計簿データベース構築プロジェクト記録

## 1. プロジェクト環境構築

### 基本構成
```
.
├── .devcontainer/
│   └── devcontainer.json    # VSCode開発コンテナの設定
├── Docker
│   ├── Dockerfile          # Pythonコンテナの定義
│   └── docker-compose.yml  # コンテナ構成の定義
├── SQLTables.numbers
├── data
│   ├── csv
│   │   ├── bank           # ?
│   │   └── card           # ?
│   └── processed           # ?
├── memo
│   ├── # 家計簿データベース設計書.md
│   ├── ChartWithClaude.md
│   └── 家計簿データベース構造定義_2024年12月31日.md
├── readme.md
└── src                    # ソースコード用
    ├── img
    │   ├── facebook_profile_image.png
    │   ├── linkedin_banner_image_1.png
    │   └── readme_banner.png
    ├── import_card_data.py
    ├── test_flet.py
    └── test_import_card_data.py

```

### 設定ファイル内容

**devcontainer.json**
```json
{
    "name": "Finance DB",
    "dockerComposeFile": ["../Docker/docker-compose.yml"],
    "service": "web",
    "workspaceFolder": "/workspace",
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-python.python",
                "ms-azuretools.vscode-docker",
                "ms-toolsai.jupyter",
                "ms-toolsai.jupyter-keymap",
                "ms-toolsai.jupyter-renderers",
                "ms-python.black-formatter"
            ]
        }
    },
    "remoteUser": "root",
    "shutdownAction": "stopCompose"
}
```

**Dockerfile**
```dockerfile
FROM python:3
ENV PYTHONUNBUFFERED 1

# システムパッケージのインストール
RUN apt-get update \
    && apt-get install -y postgresql-client \
    && apt-get install -y nodejs npm \
    && rm -rf /var/lib/apt/lists/*

# Pythonパッケージのインストール
RUN pip install django psycopg2 pandas \
    # Jupyter関連パッケージ
    jupyterlab \
    ipykernel \
    # GUI開発用パッケージ
    flet \
    # データ可視化パッケージ
    matplotlib \
    seaborn \
    plotly \
    # 開発支援パッケージ
    black \
    flake8 \
    pytest

# Jupyter kernel の設定
RUN python -m ipykernel install --user --name=finance-kernel --display-name="Finance Project Python"

# 作業ディレクトリの設定
WORKDIR /workspace
```

**docker-compose.yml**
```yaml
services:
  web:
    build: .
    tty: true
    volumes:
      - ../:/workspace
    ports:
      - "8000:8000"
      - "8550:8550"  # Flet用ポート
      - "8888:8888"  # Jupyter用ポート
    depends_on:
      - db

  db:
    image: postgres
    volumes:
      - postgres_data:/var/lib/postgresql/data
    environment:
      POSTGRES_DB: financedb
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
    ports:
      - "5432:5432"

volumes:
  postgres_data:
```

## 2. データベース設計

[previous tables section remains the same]

## 3. アプリケーション機能

### GUI機能（Flet）
- データ入力フォーム
- 取引履歴の表示
- カテゴリ別集計表示
- グラフ表示機能

### データ分析機能（Jupyter）
- 支出パターンの分析
- カテゴリ別の統計分析
- 予算と実績の比較

### 可視化機能
- matplotlib/seaborn: 静的グラフ生成
- plotly: インタラクティブな可視化
- カテゴリ別支出の円グラフ
- 月次推移の折れ線グラフ
- 予算vs実績のバーチャート

## 4. データ取り込み処理

[previous CSV format section remains the same]

## 5. 将来の拡張性

[previous section remains the same with budgets table]

### 実装の優先順位
1. 基本テーブルの作成 ✓
2. データベース接続設定 ✓
3. GUI基本機能の実装
4. CSVインポート機能
5. 自動分類ロジック
6. 集計・分析機能
7. 可視化機能
8. 予算管理機能（将来）
9. 中項目による詳細分類（将来）

## 6. 特記事項

[previous notes section remains the same]

### 開発環境の注意点
- Fletアプリケーションは8550ポートを使用
- JupyterLabは8888ポートを使用
- PostgreSQLは5432ポートを使用
- コンテナ内での作業は `/workspace` ディレクトリで実施
